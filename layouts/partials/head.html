<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="index, follow">
  <meta http-equiv="content-language" content="en">

  <!-- Resource hints for third-party origins -->
  <link rel="dns-prefetch" href="https://www.googletagmanager.com">
  <link rel="preconnect" href="https://img.youtube.com" crossorigin>

  {{/* Preload LCP hero image on homepage */}}
  {{ if .IsHome }}
    {{ $heroImg := resources.Get site.Data.main.header_image }}
    {{ $hero250 := $heroImg.Resize "250x webp" }}
    {{ $hero300 := $heroImg.Resize "300x webp" }}
    {{ $hero400 := $heroImg.Resize "400x webp" }}
    <link rel="preload" as="image" type="image/webp" fetchpriority="high"
      imagesrcset="{{ $hero250.RelPermalink }} 250w, {{ $hero300.RelPermalink }} 300w, {{ $hero400.RelPermalink }} 400w"
      imagesizes="(max-width: 480px) 250px, (max-width: 768px) 300px, 400px">
  {{ end }}

  <!-- Self-hosted fonts: preload critical font for LCP -->
  {{ if .IsHome }}
  <link rel="preload" href="/fonts/anton-v25-latin-regular.woff2" as="font" type="font/woff2" crossorigin>
  {{ end }}
  <link rel="preload" href="/fonts/inter-latin.woff2" as="font" type="font/woff2" crossorigin>

  {{/* Title: unique per page type */}}
  {{ if .IsHome }}
  <title>{{ site.Title }}</title>
  {{ else }}
  <title>{{ .Title }} | {{ site.Title }}</title>
  {{ end }}

  {{/* Description: use page description, then summary, then site default */}}
  {{ $description := site.Params.description }}
  {{ with .Description }}{{ $description = . }}{{ else }}{{ with .Summary }}{{ $description = . | plainify | truncate 155 }}{{ end }}{{ end }}
  <meta name="description" content="{{ $description }}">

  {{/* Open Graph: proper og:type per section */}}
  {{ $ogType := "website" }}
  {{ if and .IsPage (or (eq .Section "blog") (eq .Section "podcast")) }}
    {{ $ogType = "article" }}
  {{ end }}
  <meta property="og:type" content="{{ $ogType }}">
  <meta property="og:url" content="{{ .Permalink }}">
  <meta property="og:title" content="{{ .Title }}">
  <meta property="og:description" content="{{ $description }}">
  <meta property="og:image" content="{{ with .Params.image }}{{ . | absURL }}{{ else }}{{ site.Data.main.social.image | absURL }}{{ end }}">

  <!-- LinkedIn -->
  <meta property="og:site_name" content="{{ site.Title }}">
  <meta property="article:author" content="{{ site.Data.main.social.linkedIn }}">
  {{ if and .IsPage (or (eq .Section "blog") (eq .Section "podcast")) }}
  <meta property="article:published_time" content="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">
  {{ end }}

  <!-- X (formerly Twitter) -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@{{ site.Data.main.social.twitter }}">
  <meta name="twitter:creator" content="@{{ site.Data.main.social.twitter }}">
  <meta name="twitter:title" content="{{ .Title }}">
  <meta name="twitter:description" content="{{ $description }}">
  <meta name="twitter:image" content="{{ with .Params.image }}{{ . | absURL }}{{ else }}{{ site.Data.main.social.image | absURL }}{{ end }}">

  <!-- Social Profile Links -->
  <link rel="me" href="{{ site.Data.main.social.github }}">
  <link rel="me" href="{{ site.Data.main.social.linkedIn }}">
  <link rel="me" href="{{ site.Data.main.social.mastodon }}">

  <!-- Schema.org Person -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Person",
    "name": "Viktor Petersson",
    "url": "{{ site.BaseURL }}",
    "jobTitle": "CEO & Founder",
    "image": "{{ site.Data.main.social.image | absURL }}",
    "sameAs": [
      "{{ site.Data.main.social.github }}",
      "{{ site.Data.main.social.linkedIn }}",
      "{{ site.Data.main.social.mastodon }}",
      "{{ site.Data.main.social.x }}"
    ]
  }
  </script>

  {{ if .IsHome }}
  <!-- Schema.org WebSite with SearchAction -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": {{ site.Title | jsonify }},
    "url": "{{ site.BaseURL }}",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "{{ site.BaseURL }}search/?query={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>
  {{ end }}

  {{ with .Params.keywords }}
  <meta name="keywords" content="{{ . }}">
  {{ end }}

  {{/* Critical CSS inlined for fast FCP */}}
  {{ $critical := resources.Get "css/critical.css" }}
  {{ if hugo.IsProduction }}{{ $critical = $critical | minify }}{{ end }}
  <style>{{ $critical.Content | safeCSS }}</style>

  {{/* Full CSS bundle (render-blocking to prevent CLS) */}}
  {{ $sass := resources.Get "css/main.scss" | toCSS }}
  {{ $tailwind := resources.Get "css/tailwind.css" | css.TailwindCSS }}
  {{ $native := resources.Get "css/native.css" }}
  {{ $styles := slice $sass $tailwind $native | resources.Concat "css/bundle.css" }}
  {{ if hugo.IsProduction }}
    {{ $styles = $styles | minify | fingerprint }}
  {{ end }}
  <link rel="stylesheet" href="{{ $styles.RelPermalink }}">

  {{ partial "google-analytics.html" . }}

  <link rel="canonical" href="{{ .Permalink }}" />
</head>
